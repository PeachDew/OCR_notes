## Chandra by Datalab
An OCR model that tops independent olmocr benchmark. They created the open-source tools Marker/Surya (OCR toolkits).

### Changes from old approach
For marker/surya they had a "pipeline" approach
1) Segment page into blocks (layout analysis)
2) Perform OCR on each block separately
3) Stitch blocks back together

But this fails on complex layouts where boundaries are ambiguous
 - handwriting over forms

### New approach: full page decoding
Chandra looks at the entire page at once and decodes it linearly, not relying on pre-segmentation.

With "global vision" it learns to understand relationships between elements
 - eg. caption belings to an image

### Speculative Decoding
Not running raw transformer, they optimise for latency using Speculative Decoding
 - Before, LLMs generate tokens one by one
 - They use a smaller "draft" model to predict the next few tokens rapidly (in a tree structure not just a line)
    - larger "target" model then verifies these drafts in parallel
 - result: allows them to run very large models with the latency of a much smaller model

### Vision-only LLMS not the way to go
They advise against relying solely on Multimodal LLMs for data extraction from images
 - vision only LLMs struggle with **dense** data, eg. skipping rows in tables/spatial confusion (rotated text)

Their recommended fix is feeding LLMs both  the image and the high-fidelity Markdown text generated by OCR models. The OCR text provides the "grounding" that prevents LLMs from hallucinating or missing data.

### For long documents
Page-level OCR was found to be insufficient, they found that
 - Standard OCR models processes one page at a time
 - Missing context in longer documents

Instead of making their main model bigger, they built a specialized, lightweight model specifically for hierarchy
1) Chandra extracts texts and identifies candidate headers on every page independently
2) Agni, their smaller context model takes the sequence of headers across 100+ pages, and enforces a consistent tree structure and corrects the page-level guesses
 - (H1 -> H2 -> H3)

Separating the OCR and the Hierarchy part.
